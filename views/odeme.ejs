<!DOCTYPE html>
<html lang="tr" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GÃ¼venli Ã–deme SayfasÄ±</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
    
    <style>
     /* ================================================== */
/* âœ… Ã–DEME SÄ°STEMÄ° CSS GÃœNCELLEME - TEMAYA UYUMLU âœ… */
/* ================================================== */

/* Renk ve Temel DeÄŸiÅŸkenler */
:root {
    --primary-color: #70020F; /* Rosewood */
    --secondary-color: #FFDEE2; /* Misty Rose */
    --button-hover: #920315;
    --input-border: #D4AF37; /* Gold accent ile uyumlu */
    --success-color: #28a745;
    --white: #FFFFFF;
}

/* Genel Body ve Font AyarlarÄ± */
body {
    font-family: 'Roboto', sans-serif;
    background-color: var(--secondary-color);
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
    color: var(--primary-color);
}

/* Navigasyon Ã‡ubuÄŸu */
.navbar {
    width: 100%;
    background-color: var(--primary-color);
    color: var(--white);
    padding: 15px 30px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
}

.navbar nav a {
    color: var(--white);
    text-decoration: none;
    margin-left: 25px;
    font-weight: 500;
    transition: color 0.3s;
}

.navbar nav a:hover {
    color: var(--secondary-color);
}

/* KullanÄ±cÄ± Ä°ÅŸlemleri */
.user-actions a {
    color: var(--white);
    text-decoration: none;
    margin-left: 15px;
    font-size: 1.2em;
}

/* Ã–deme Konteyneri */
.main-content {
    flex-grow: 1;
    display: flex;
    justify-content: center;
    align-items: center;
    width: 100%;
    padding: 20px;
}

.payment-container {
    background-color: var(--white);
    padding: 30px;
    border-radius: 12px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.1);
    width: 100%;
    max-width: 500px;
}

h2 {
    color: var(--primary-color);
    border-bottom: 2px solid var(--secondary-color);
    padding-bottom: 15px;
    margin-bottom: 25px;
    text-align: center;
}

/* Ã–deme SeÃ§enekleri */
.payment-options {
    display: flex;
    justify-content: space-around;
    margin-bottom: 25px;
}

.payment-option {
    flex-grow: 1;
    text-align: center;
    padding: 15px;
    margin: 0 5px;
    border: 2px solid var(--input-border);
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-weight: bold;
}

.payment-option:hover {
    border-color: var(--primary-color);
    background-color: #FFF0F2;
}

.payment-option.active {
    border-color: var(--primary-color);
    background-color: var(--primary-color);
    color: var(--white);
}

.payment-option i {
    margin-right: 10px;
    font-size: 1.2em;
}

/* Form AlanlarÄ± */
.form-group {
    margin-bottom: 20px;
}

label {
    display: block;
    margin-bottom: 8px;
    font-weight: 600;
    color: #333;
}

input[type="text"],
input[type="number"],
input[type="email"],
.expiry-date-group select {
    width: 100%;
    padding: 12px;
    border: 1px solid var(--input-border);
    border-radius: 6px;
    box-sizing: border-box;
    transition: border-color 0.3s;
    font-size: 16px;
}

input:focus, .expiry-date-group select:focus {
    border-color: var(--primary-color);
    outline: none;
    box-shadow: 0 0 0 3px rgba(112,2,15,0.2);
}

.expiry-date-group {
    display: flex;
    gap: 10px;
}

.expiry-date-group div {
    flex-grow: 1;
}

/* Ã–deme Butonu */
.pay-button {
    width: 100%;
    padding: 15px;
    background-color: var(--primary-color);
    color: var(--white);
    border: none;
    border-radius: 8px;
    font-size: 18px;
    font-weight: bold;
    cursor: pointer;
    transition: background-color 0.3s ease;
}

.pay-button:hover {
    background-color: var(--button-hover);
}

/* PayPal Ã–zel Renkleri */
#paypal-info .pay-button {
    background-color: #6b062d;
}

#paypal-info .pay-button:hover {
    background-color: #920315;
}

/* GÃ¼venlik Notu */
.security-note {
    text-align: center;
    margin-top: 20px;
    color: var(--primary-color);
    font-size: 0.9em;
}

.security-note i {
    margin-right: 5px;
}

/* Formlar baÅŸlangÄ±Ã§ durumu */
#card-form-container { display: block; }
#paypal-info { display: none; }

/* Mobil Uyumlu Ã–deme Sistemi */
@media (max-width: 900px) {
    .payment-options { flex-direction: column; gap: 10px; }
    .payment-option { margin: 0; }
    .main-content { padding: 10px; }
}

    </style>
</head>
<body>
    
    <header class="navbar">
    <div class="logo">chefWallet</div>
    <nav>
    <a href="/">Ana Sayfa</a>
    <a href="/tarifler">Tarifler</a>
    <a href="/market">Market</a>
    <a href="/hakkimizda">HakkÄ±mÄ±zda</a>
    <a href="/iletisim">Ä°letiÅŸim</a>

    </nav>
    <div class="user-actions">
        <a href="/giris" class="login-link" style="margin-right: 10px;">ðŸ‘¤ GiriÅŸ Yap</a> 
        <a href="/sepet" class="cart-link">ðŸ›’</a>
    </div>
</header>
    <div class="main-content">
        <div class="payment-container">
            <h2>Ã–deme Ä°ÅŸlemini Tamamla</h2>
            
            <div class="payment-options">
                <div class="payment-option active" id="visa-option" onclick="selectPayment('visa')">
                    <i class="fab fa-cc-visa"></i> Kredi / Banka KartÄ±
                </div>
                <div class="payment-option" id="paypal-option" onclick="selectPayment('paypal')">
                    <i class="fab fa-paypal"></i> PayPal
                </div>
            </div>

            <form id="card-form-container">
                <div class="form-group">
                    <label for="card-number">Kart NumarasÄ±</label>
                    <input type="text" id="card-number" placeholder="xxxx xxxx xxxx xxxx" required maxlength="19">
                    <p class="error-message" id="card-number-error"></p>
                </div>

                <div class="form-group">
                    <label for="card-name">Kart Ãœzerindeki Ä°sim</label>
                    <input type="text" id="card-name" required>
                </div>
                
                <div class="form-group">
                    <label>Son Kullanma Tarihi</label>
                    <div class="expiry-date-group">
                        <div>
                            <select id="exp-month" required>
                                <option value="">Ay</option>
                                <script>
                                    for (let i = 1; i <= 12; i++) {
                                        document.write(`<option value="${i}">${i < 10 ? '0' + i : i}</option>`);
                                    }
                                </script>
                            </select>
                        </div>
                        <div>
                            <select id="exp-year" required>
                                <option value="">YÄ±l</option>
                                <script>
                                    const currentYear = new Date().getFullYear();
                                    for (let i = 0; i < 10; i++) {
                                        document.write(`<option value="${currentYear + i}">${currentYear + i}</option>`);
                                    }
                                </script>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="cvv">GÃ¼venlik Kodu (CVV)</label>
                    <input type="text" id="cvv" placeholder="Ã–rn: 123" required maxlength="4" style="max-width: 100px;">
                    <p class="error-message" id="cvv-error"></p>
                </div>

                <button type="submit" class="pay-button">Åžimdi Ã–de 550.00 TRY</button>
            </form>

            <div id="paypal-info">
                <p>Ã–deme iÅŸlemini tamamlamak iÃ§in gÃ¼venli PayPal sayfasÄ±na yÃ¶nlendirileceksiniz.</p>
                <button class="pay-button">
                    <i class="fab fa-paypal" style="margin-right: 10px;"></i> PayPal ile Ã–de
                </button>
            </div>
            
            <div class="security-note">
                <i class="fas fa-lock"></i> Ã–deme iÅŸleminiz tamamen gÃ¼venli ve ÅŸifrelenmiÅŸtir.
            </div>
        </div>
    </div>

    <script>
        // 1. Ã–deme YÃ¶ntemi SeÃ§imi Fonksiyonu
        function selectPayment(method) {
            const visaOption = document.getElementById('visa-option');
            const paypalOption = document.getElementById('paypal-option');
            const cardForm = document.getElementById('card-form-container');
            const paypalInfo = document.getElementById('paypal-info');

            if (method === 'visa') {
                visaOption.classList.add('active');
                paypalOption.classList.remove('active');
                cardForm.style.display = 'block';
                paypalInfo.style.display = 'none';
            } else if (method === 'paypal') {
                visaOption.classList.remove('active');
                paypalOption.classList.add('active');
                cardForm.style.display = 'none';
                paypalInfo.style.display = 'block';
            }
        }
        
        // 2. Kart NumarasÄ± Formatlama ve Kontrol Fonksiyonu
        document.getElementById('card-form-container').addEventListener('submit', function(e) {
            e.preventDefault(); 
            
            const cardNumberInput = document.getElementById('card-number');
            const cvvInput = document.getElementById('cvv');
            
            let isValid = true;

            // Kontrol 1: Kart NumarasÄ±
            const cardNumber = cardNumberInput.value.replace(/\s/g, ''); 
            if (cardNumber.length < 13 || cardNumber.length > 19 || !/^\d+$/.test(cardNumber)) {
                alert('Hata: GeÃ§erli bir Kart NumarasÄ± giriniz (13-19 hane).');
                cardNumberInput.focus();
                isValid = false;
            }

            // Kontrol 2: CVV
            const cvv = cvvInput.value;
            if (isValid && (cvv.length < 3 || cvv.length > 4 || !/^\d+$/.test(cvv))) {
                alert('Hata: GeÃ§erli bir CVV kodu giriniz (3 veya 4 hane).');
                cvvInput.focus();
                isValid = false;
            }

            // EÄŸer tÃ¼m kontroller baÅŸarÄ±lÄ±ysa, veriyi arka uca (Backend) gÃ¶nder
            if (!isValid) {
                 errorMessage.textContent = 'Kart bilgileri geÃ§ersiz. LÃ¼tfen kontrol edin.';
                    return;
                }      

            if (isValid) {
                  alert("Ã–deme baÅŸarÄ±lÄ±!");
                 window.location.href = "index.html";  // Ana sayfaya yÃ¶nlendir
                }
        });
        
        // Ä°steÄŸe baÄŸlÄ±: Kart numarasÄ±nÄ± gruplara ayÄ±rma (4 hanede bir boÅŸluk)
        document.getElementById('card-number').addEventListener('input', function (e) {
            let value = e.target.value.replace(/\s/g, ''); 
            let formattedValue = '';
            for (let i = 0; i < value.length; i++) {
                if (i > 0 && i % 4 === 0) {
                    formattedValue += ' ';
                }
                formattedValue += value[i];
            }
            e.target.value = formattedValue;
        });

    
    // 1. Ã–deme YÃ¶ntemi SeÃ§imi Fonksiyonu (AynÄ± KalÄ±r)
    function selectPayment(method) {
        const visaOption = document.getElementById('visa-option');
        const paypalOption = document.getElementById('paypal-option');
        const cardForm = document.getElementById('card-form-container');
        const paypalInfo = document.getElementById('paypal-info');

        if (method === 'visa') {
            visaOption.classList.add('active');
            paypalOption.classList.remove('active');
            cardForm.style.display = 'block';
            paypalInfo.style.display = 'none';
        } else if (method === 'paypal') {
            visaOption.classList.remove('active');
            paypalOption.classList.add('active');
            cardForm.style.display = 'none';
            paypalInfo.style.display = 'block';
        }
    }

    // YardÄ±mcÄ± Fonksiyon: Hata mesajÄ±nÄ± gÃ¶sterir
    function displayError(inputElement, message) {
        // Hata mesajÄ± iÃ§in dinamik bir p etiketi oluÅŸturur veya gÃ¼nceller
        let errorElement = document.getElementById(inputElement.id + '-error');
        if (!errorElement) {
            errorElement = document.createElement('p');
            errorElement.className = 'error-message';
            errorElement.id = inputElement.id + '-error';
            inputElement.parentNode.appendChild(errorElement);
        }
        errorElement.textContent = message;
        errorElement.style.color = '#ff0000'; // KÄ±rmÄ±zÄ± hata rengi
        inputElement.style.borderColor = '#ff0000';
    }

    // YardÄ±mcÄ± Fonksiyon: Hata mesajÄ±nÄ± temizler
    function clearError(inputElement) {
        const errorElement = document.getElementById(inputElement.id + '-error');
        if (errorElement) {
            errorElement.textContent = '';
            inputElement.style.borderColor = ''; // VarsayÄ±lana dÃ¶ner
        }
    }

    // --- 2. Input AlanlarÄ±na AnlÄ±k KÄ±sÄ±tlamalar ve Formatlama ---
    
    // Kart NumarasÄ± (Sadece Rakam ve 4 Hanede Bir BoÅŸluk)
    document.getElementById('card-number').addEventListener('input', function (e) {
        let input = e.target;
        // Sadece rakamlarÄ± tut
        let value = input.value.replace(/[^0-9]/g, ''); 
        
        let formattedValue = '';
        for (let i = 0; i < value.length; i++) {
            if (i > 0 && i % 4 === 0) {
                formattedValue += ' ';
            }
            formattedValue += value[i];
        }
        input.value = formattedValue;
        clearError(input);
    });

    // GÃ¼venlik Kodu (CVV) - Sadece Rakam
    document.getElementById('cvv').addEventListener('input', function (e) {
        let input = e.target;
        // Sadece rakamlarÄ± tut
        input.value = input.value.replace(/[^0-9]/g, ''); 
        clearError(input);
    });

    // Kart Ãœzerindeki Ä°sim (Sadece Ä°ngilizce Karakter, BoÅŸluk ve Tire)
    document.getElementById('card-name').addEventListener('input', function (e) {
        let input = e.target;
        // A-Z, a-z, boÅŸluk ve tire (-) dÄ±ÅŸÄ±ndaki her ÅŸeyi kaldÄ±rÄ±r.
        input.value = input.value.replace(/[^A-Za-z\s-]/g, ''); 
        clearError(input);
    });
    
    // --- 3. Form GÃ¶nderiminde KapsamlÄ± Kontroller ---

    document.getElementById('card-form-container').addEventListener('submit', function(e) {
        e.preventDefault(); 
        
        const cardNumberInput = document.getElementById('card-number');
        const cvvInput = document.getElementById('cvv');
        const cardNameInput = document.getElementById('card-name');
        const expMonthSelect = document.getElementById('exp-month');
        const expYearSelect = document.getElementById('exp-year');
        
        let isValid = true;
        
        // TÃ¼m hata mesajlarÄ±nÄ± temizle
        [cardNumberInput, cvvInput, cardNameInput, expMonthSelect, expYearSelect].forEach(clearError);

        // A. Kart NumarasÄ± KontrolÃ¼ (13-19 hane)
        const cardNumber = cardNumberInput.value.replace(/\s/g, ''); 
        if (cardNumber.length < 13 || cardNumber.length > 19 || !/^\d+$/.test(cardNumber)) {
            displayError(cardNumberInput, 'GeÃ§erli bir Kart NumarasÄ± giriniz (13-19 hane).');
            isValid = false;
        }

        // B. CVV KontrolÃ¼ (3 veya 4 hane)
        const cvv = cvvInput.value;
        if (cvv.length < 3 || cvv.length > 4 || !/^\d+$/.test(cvv)) {
            displayError(cvvInput, 'GeÃ§erli bir CVV kodu giriniz (3 veya 4 hane).');
            isValid = false;
        }

        // C. Kart Ãœzerindeki Ä°sim KontrolÃ¼ (BoÅŸ olmamalÄ±)
        if (cardNameInput.value.trim() === '') {
             displayError(cardNameInput, 'Kart Ã¼zerindeki isim boÅŸ olamaz.');
             isValid = false;
        }


        // D. Son Kullanma Tarihi KontrolÃ¼ (GeÃ§erli ve Gelecekte OlmalÄ±)
        const selectedMonth = parseInt(expMonthSelect.value);
        const selectedYear = parseInt(expYearSelect.value);
        
        if (isNaN(selectedMonth) || isNaN(selectedYear)) {
            // Dropdown'larÄ±n zaten 'required' olmasÄ± bu durumu nadiren gÃ¶sterir
            displayError(expYearSelect, 'LÃ¼tfen son kullanma tarihini seÃ§iniz.');
            isValid = false;
        } else {
            const currentDate = new Date();
            const currentYear = currentDate.getFullYear();
            // JS'de aylar 0 (Ocak) ile baÅŸlar, seÃ§ilen ay 1'den baÅŸlar, bu yÃ¼zden 1 Ã§Ä±karÄ±lÄ±r.
            const currentMonth = currentDate.getMonth() + 1; 

            if (selectedYear < currentYear) {
                // SeÃ§ilen yÄ±l geÃ§miÅŸte
                displayError(expYearSelect, 'Son kullanma tarihi geÃ§miÅŸ olamaz.');
                isValid = false;
            } else if (selectedYear === currentYear && selectedMonth < currentMonth) {
                // SeÃ§ilen yÄ±l gÃ¼ncel yÄ±l ancak seÃ§ilen ay geÃ§miÅŸte
                displayError(expYearSelect, 'SeÃ§ilen ay geÃ§miÅŸ bir tarih.');
                isValid = false;
            }
        }
  
    });
// odeme.html sayfasÄ±nda
window.onload = function() {
    let odemeTutari = localStorage.getItem("odemeToplamTutar") || "0.00";
    
    // Ã–deme tutarÄ±nÄ± ekranda gÃ¶ster
    document.getElementById("odemeTutari").innerText = "â‚º" + odemeTutari;
    
    // Form gÃ¶nderiminde kullanmak iÃ§in
    document.getElementById("tutarInput").value = odemeTutari;
};
    // Bu kod Ã¶deme sayfanÄ±zÄ±n JS bloÄŸuna veya dosyasÄ±na eklenmelidir.
document.addEventListener('DOMContentLoaded', () => {
    // LocalStorage'dan sepetin nihai tutarÄ±nÄ± Ã§ek
    const odenecekTutar = localStorage.getItem('odemeToplamTutar');
    
    // Formatlama ve VarsayÄ±lan deÄŸer atama (Tutar yoksa 0.00)
    const nihaiTutar = odenecekTutar ? odenecekTutar : '0.00'; 
    const formatliTutar = parseFloat(nihaiTutar).toFixed(2);
    
    // Ã–deme Butonunu GÃ¼ncelle
    const payButton = document.querySelector('.pay-button'); 
    
    if (payButton) {
        payButton.innerHTML = `<i class="fas fa-lock"></i>Åžimdi Ã–de ${formatliTutar} TRY`; 
        
    }
});
    </script>

</body>
</html>